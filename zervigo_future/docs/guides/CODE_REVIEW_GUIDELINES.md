# JobFirst 代码审查指南

## 🎯 代码审查目标

### 1. 代码质量
- 确保代码符合项目标准
- 提高代码可读性和可维护性
- 减少bug和技术债务

### 2. 知识共享
- 团队成员相互学习
- 传播最佳实践
- 统一代码风格

### 3. 风险控制
- 防止有问题的代码进入主分支
- 确保安全性和性能
- 维护系统稳定性

## 📋 审查清单

### ✅ 代码质量检查

#### 1. 代码风格
- [ ] 代码格式符合项目规范
- [ ] 命名规范一致
- [ ] 注释清晰完整
- [ ] 无重复代码

#### 2. 代码结构
- [ ] 函数职责单一
- [ ] 模块化设计合理
- [ ] 依赖关系清晰
- [ ] 错误处理完善

#### 3. 性能考虑
- [ ] 无明显的性能问题
- [ ] 内存使用合理
- [ ] 数据库查询优化
- [ ] 缓存策略适当

### 🔒 安全检查

#### 1. 输入验证
- [ ] 所有用户输入都经过验证
- [ ] 防止SQL注入
- [ ] 防止XSS攻击
- [ ] 防止CSRF攻击

#### 2. 权限控制
- [ ] 访问控制正确
- [ ] 敏感信息保护
- [ ] 日志记录适当
- [ ] 错误信息不泄露敏感数据

#### 3. 依赖安全
- [ ] 依赖包版本安全
- [ ] 无已知漏洞
- [ ] 第三方服务安全
- [ ] 配置文件安全

### 🧪 测试覆盖

#### 1. 单元测试
- [ ] 核心业务逻辑有测试
- [ ] 边界条件测试
- [ ] 错误情况测试
- [ ] 测试覆盖率达标

#### 2. 集成测试
- [ ] API接口测试
- [ ] 数据库集成测试
- [ ] 服务间通信测试
- [ ] 端到端测试

#### 3. 测试质量
- [ ] 测试用例清晰
- [ ] 测试数据合理
- [ ] 测试可重复
- [ ] 测试维护性好

## 🚀 审查流程

### 1. 提交前检查
```bash
# 后端检查
cd backend
go fmt ./...                    # 代码格式化
go vet ./...                    # 静态分析
go test ./...                   # 运行测试
go test -cover ./...            # 覆盖率检查

# 前端检查
cd fronend-taro
npm run lint                    # 代码检查
npm run type-check              # 类型检查
npm test                        # 运行测试
npm run test:coverage           # 覆盖率检查
```

### 2. PR创建要求
- [ ] 功能完整实现
- [ ] 测试用例完整
- [ ] 文档更新
- [ ] 破坏性变更说明

### 3. 审查标准
- [ ] 至少2人审查
- [ ] 所有检查项通过
- [ ] 无阻塞性问题
- [ ] 性能影响评估

## 📊 质量指标

### 1. 代码质量指标
- **代码覆盖率**: 后端>=80%, 前端>=70%
- **代码复杂度**: 圈复杂度<10
- **重复代码**: 重复率<5%
- **技术债务**: 无严重技术债务

### 2. 性能指标
- **API响应时间**: <200ms
- **页面加载时间**: <3s
- **内存使用**: 无内存泄漏
- **并发处理**: 支持1000+并发

### 3. 安全指标
- **漏洞扫描**: 无高危漏洞
- **依赖安全**: 无已知漏洞
- **权限控制**: 100%覆盖
- **数据保护**: 敏感数据加密

## 🔧 工具配置

### 1. 后端工具
```yaml
# .golangci.yml
linters:
  enable:
    - gofmt
    - goimports
    - govet
    - gocyclo
    - dupl
    - gosec
    - errcheck
    - staticcheck
    - unused
    - gosimple
    - ineffassign
    - misspell
    - goconst
    - gocritic
    - godot
    - godox
    - goerr113
    - gomnd
    - gomodguard
    - gosec
    - gosimple
    - govet
    - ineffassign
    - misspell
    - nakedret
    - noctx
    - nolintlint
    - rowserrcheck
    - sqlclosecheck
    - structcheck
    - stylecheck
    - typecheck
    - unconvert
    - unparam
    - unused
    - varcheck
    - whitespace
```

### 2. 前端工具
```json
// .eslintrc.js
{
  "extends": [
    "eslint:recommended",
    "@typescript-eslint/recommended",
    "prettier"
  ],
  "rules": {
    "complexity": ["error", 10],
    "max-lines": ["error", 300],
    "max-lines-per-function": ["error", 50],
    "max-params": ["error", 4],
    "no-duplicate-imports": "error",
    "no-unused-vars": "error",
    "prefer-const": "error"
  }
}
```

## 📝 审查模板

### PR描述模板
```markdown
## 📋 变更说明
- [ ] 新功能
- [ ] Bug修复
- [ ] 性能优化
- [ ] 重构
- [ ] 文档更新

## 🔧 技术细节
- 主要变更内容
- 技术实现方案
- 性能影响评估

## 🧪 测试情况
- [ ] 单元测试
- [ ] 集成测试
- [ ] 手动测试
- [ ] 性能测试

## 📚 相关文档
- 设计文档链接
- API文档更新
- 用户手册更新

## ⚠️ 注意事项
- 破坏性变更说明
- 数据库迁移说明
- 配置变更说明
```

### 审查评论模板
```markdown
## ✅ 通过项目
- 代码质量良好
- 测试覆盖充分
- 性能影响可接受
- 安全性检查通过

## ⚠️ 需要改进
- 具体改进建议
- 代码优化建议
- 测试补充建议

## ❌ 阻塞问题
- 严重问题说明
- 必须修复的问题
- 安全风险问题
```

## 🎯 最佳实践

### 1. 审查者
- 保持客观公正
- 提供建设性建议
- 及时响应审查请求
- 关注代码质量而非个人偏好

### 2. 提交者
- 认真对待审查意见
- 及时回复和修改
- 保持PR更新
- 主动沟通问题

### 3. 团队协作
- 定期回顾审查流程
- 分享最佳实践
- 持续改进工具配置
- 培训新团队成员

## 📈 持续改进

### 1. 指标监控
- 审查时间统计
- 代码质量趋势
- 缺陷发现率
- 团队满意度

### 2. 流程优化
- 定期评估审查流程
- 优化工具配置
- 简化审查步骤
- 提高审查效率

### 3. 知识管理
- 建立审查知识库
- 记录常见问题
- 分享最佳实践
- 定期培训更新
