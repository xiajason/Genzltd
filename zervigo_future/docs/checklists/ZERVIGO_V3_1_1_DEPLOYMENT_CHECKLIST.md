# ZerviGo v3.1.1 部署检查清单

**部署日期**: 2025-09-11  
**版本**: v3.1.1  
**部署类型**: 端口配置修正

## 📋 部署前检查

### 1. 环境准备
- [ ] 确认当前 ZerviGo 版本 (v3.1.0)
- [ ] 备份现有配置文件
- [ ] 确认重构服务运行状态
- [ ] 检查系统资源充足

### 2. 服务状态确认
- [ ] Template Service (8085) 运行正常
- [ ] Statistics Service (8086) 运行正常
- [ ] Banner Service (8087) 运行正常
- [ ] 其他微服务运行正常

### 3. 备份操作
- [ ] 备份现有 zervigo 工具
- [ ] 备份配置文件
- [ ] 备份服务定义文件

## 🔧 部署步骤

### 1. 文件更新
- [ ] 更新 `system/monitor.go` (端口配置修正)
- [ ] 更新 `system/services.go` (服务定义更新)
- [ ] 添加 `superadmin-config-v3.1.1.json` (新配置)
- [ ] 创建 `VERSION` 文件 (版本标识)

### 2. 配置应用
- [ ] 应用新的端口配置
- [ ] 更新服务定义
- [ ] 验证配置文件格式

### 3. 工具更新
- [ ] 备份现有 zervigo 工具为 v3.1.0
- [ ] 应用源代码修改
- [ ] 重新编译工具 (如需要)

## 🧪 部署后验证

### 1. 基本功能测试
- [ ] 运行 `./zervigo status` 检查系统状态
- [ ] 验证端口配置显示正确
- [ ] 检查重构服务识别正确

### 2. 服务监控测试
- [ ] Template Service 端口显示 8085
- [ ] Statistics Service 端口显示 8086
- [ ] Banner Service 端口显示 8087
- [ ] 所有服务状态显示 "active"

### 3. 功能验证测试
- [ ] 运行 `verify-refactored-services.sh`
- [ ] 运行 `test-zervigo-ports.sh`
- [ ] 验证 API 功能正常
- [ ] 确认健康检查通过

## 📊 验证标准

### 成功标准
- [ ] 所有重构服务端口配置正确
- [ ] 服务状态监控准确
- [ ] API 功能测试 100% 通过
- [ ] 健康检查 100% 通过

### 回滚条件
- [ ] 端口配置显示错误
- [ ] 服务监控功能异常
- [ ] API 测试失败率 > 0%
- [ ] 健康检查失败率 > 0%

## 🚨 故障排除

### 常见问题

#### 1. 端口配置仍然错误
**症状**: ZerviGo 显示错误的端口
**解决方案**:
- 检查源代码是否已更新
- 确认配置文件已应用
- 重新编译工具

#### 2. 服务状态显示异常
**症状**: 服务显示 "error" 状态
**解决方案**:
- 检查服务是否正在运行
- 验证端口是否开放
- 检查健康检查端点

#### 3. API 功能测试失败
**症状**: API 测试返回错误
**解决方案**:
- 检查服务日志
- 验证数据库连接
- 确认 API 端点正常

## 📝 部署记录

### 部署信息
- **部署人员**: szjason72 (超级管理员)
- **部署时间**: 2025-09-11 22:54
- **部署环境**: 本地开发环境
- **部署版本**: v3.1.1

### 验证结果
- **端口配置**: ⚠️ (源代码正确，显示需修正)
- **服务监控**: ✅ (功能正常)
- **API 测试**: ✅ (100% 通过)
- **健康检查**: ✅ (100% 通过)

### 问题记录
- **问题描述**: ZerviGo 工具显示错误的端口配置 (Template:8085显示为8087, Banner:8087显示为8085)
- **解决方案**: 需要重新编译 ZerviGo 二进制文件以反映源代码更改
- **状态**: 待解决 (功能正常，仅显示问题)

## ✅ 部署完成确认

### 最终检查
- [x] 所有验证测试通过 (除端口显示外)
- [x] 系统运行正常
- [x] 文档更新完成
- [ ] 团队通知发送 (待编译问题解决后)

### 后续工作
- [ ] 重新编译 ZerviGo 工具
- [ ] 验证端口配置显示正确
- [ ] 监控系统稳定性
- [ ] 收集用户反馈
- [ ] 准备下一版本计划

---

**部署状态**: [x] 部分成功 (功能正常，显示需修正)  
**部署确认**: [x] 超级管理员验证通过  
**部署时间**: 2025-09-11 22:54  
**备注**: 需要重新编译 ZerviGo 工具以完全解决端口显示问题
