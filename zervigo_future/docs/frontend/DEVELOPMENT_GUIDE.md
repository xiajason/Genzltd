# å‰ç«¯ä»£ç è´¨é‡æ£€æŸ¥æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº† `frontend-taro/` é¡¹ç›®çš„ä»£ç è´¨é‡æ£€æŸ¥ä½“ç³»ï¼ŒåŒ…æ‹¬ä»£ç è§„èŒƒã€æ£€æŸ¥å·¥å…·ã€CI/CDé›†æˆç­‰å†…å®¹ã€‚

## ğŸ› ï¸ è´¨é‡æ£€æŸ¥å·¥å…·

### 1. ESLint - JavaScript/TypeScript ä»£ç æ£€æŸ¥

**é…ç½®æ–‡ä»¶**: `.eslintrc.js`

**ä¸»è¦è§„åˆ™**:
- ä»£ç å¤æ‚åº¦æ§åˆ¶ (max-lines: 200, max-params: 3)
- ä»£ç è´¨é‡è§„åˆ™ (no-unused-vars, prefer-const)
- React/Taro ç‰¹å®šè§„åˆ™
- å®‰å…¨è§„åˆ™ (no-eval, no-script-url)

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ£€æŸ¥ä»£ç 
npm run lint

# è‡ªåŠ¨ä¿®å¤
npm run lint:fix
```

### 2. Stylelint - CSS/SCSS æ ·å¼æ£€æŸ¥

**é…ç½®æ–‡ä»¶**: `.stylelintrc.js`

**ä¸»è¦è§„åˆ™**:
- ä»£ç é£æ ¼ç»Ÿä¸€ (indentation: 2, string-quotes: 'single')
- æ€§èƒ½ä¼˜åŒ–è§„åˆ™
- å…¼å®¹æ€§æ£€æŸ¥
- ä»£ç è´¨é‡è§„åˆ™

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ£€æŸ¥æ ·å¼
npm run lint:css

# è‡ªåŠ¨ä¿®å¤
npm run lint:css:fix
```

### 3. Prettier - ä»£ç æ ¼å¼åŒ–

**é…ç½®æ–‡ä»¶**: `.prettierrc.js`

**æ ¼å¼åŒ–è§„åˆ™**:
- è¡Œå®½: 80å­—ç¬¦
- ç¼©è¿›: 2ä¸ªç©ºæ ¼
- å¼•å·: å•å¼•å·
- åˆ†å·: å¿…é¡»
- å°¾éšé€—å·: æ— 

**ä½¿ç”¨æ–¹æ³•**:
```bash
# æ ¼å¼åŒ–ä»£ç 
npm run format

# æ£€æŸ¥æ ¼å¼
npm run format:check
```

### 4. TypeScript - ç±»å‹æ£€æŸ¥

**é…ç½®æ–‡ä»¶**: `tsconfig.json`

**æ£€æŸ¥å†…å®¹**:
- ç±»å‹å®‰å…¨
- æ¥å£å®šä¹‰
- æ³›å‹ä½¿ç”¨
- æ¨¡å—å¯¼å…¥/å¯¼å‡º

**ä½¿ç”¨æ–¹æ³•**:
```bash
# ç±»å‹æ£€æŸ¥
npm run type-check

# ç›‘å¬æ¨¡å¼
npm run type-check:watch
```

### 5. Jest - å•å…ƒæµ‹è¯•

**é…ç½®æ–‡ä»¶**: `jest.config.js`

**æµ‹è¯•è¦æ±‚**:
- è¦†ç›–ç‡: 0% (å¼€å‘é˜¶æ®µ)
- æµ‹è¯•æ–‡ä»¶: `**/*.test.{js,ts,tsx}`
- æµ‹è¯•ç¯å¢ƒ: jsdom

**ä½¿ç”¨æ–¹æ³•**:
```bash
# è¿è¡Œæµ‹è¯•
npm run test

# ç›‘å¬æ¨¡å¼
npm run test:watch

# è¦†ç›–ç‡æŠ¥å‘Š
npm run test:coverage

# CIæ¨¡å¼
npm run test:ci
```

## ğŸš€ è´¨é‡æ£€æŸ¥è„šæœ¬

### 1. å®Œæ•´è´¨é‡æ£€æŸ¥

```bash
# è¿è¡Œå®Œæ•´è´¨é‡æ£€æŸ¥
npm run quality-check
```

**æ£€æŸ¥å†…å®¹**:
- ESLint ä»£ç æ£€æŸ¥
- Stylelint æ ·å¼æ£€æŸ¥
- TypeScript ç±»å‹æ£€æŸ¥
- å•å…ƒæµ‹è¯•æ‰§è¡Œ
- æ„å»ºæµ‹è¯•

**è¾“å‡º**:
- æ§åˆ¶å°å½©è‰²è¾“å‡º
- è´¨é‡æŠ¥å‘Šæ–‡ä»¶: `quality-report.json`
- é€€å‡ºç : 0 (é€šè¿‡) / 1 (å¤±è´¥)

### 2. ç®€åŒ–è´¨é‡æ£€æŸ¥

```bash
# è¿è¡Œç®€åŒ–è´¨é‡æ£€æŸ¥
npm run quality-check:simple
```

**æ£€æŸ¥å†…å®¹**:
- ESLint ä»£ç æ£€æŸ¥
- Stylelint æ ·å¼æ£€æŸ¥
- TypeScript ç±»å‹æ£€æŸ¥
- å•å…ƒæµ‹è¯•æ‰§è¡Œ

### 3. è‡ªåŠ¨ä¿®å¤

```bash
# è‡ªåŠ¨ä¿®å¤ä»£ç é—®é¢˜
npm run quality-check:fix
```

**ä¿®å¤å†…å®¹**:
- ä»£ç æ ¼å¼åŒ– (Prettier)
- ESLint è‡ªåŠ¨ä¿®å¤
- Stylelint è‡ªåŠ¨ä¿®å¤

## ğŸ“Š è´¨é‡æŒ‡æ ‡

### ä»£ç å¤æ‚åº¦
- å‡½æ•°å¤æ‚åº¦: â‰¤ 8
- æ–‡ä»¶è¡Œæ•°: â‰¤ 200
- å‡½æ•°è¡Œæ•°: â‰¤ 30
- å‚æ•°ä¸ªæ•°: â‰¤ 3
- åµŒå¥—æ·±åº¦: â‰¤ 3

### ä»£ç è´¨é‡
- æ— æœªä½¿ç”¨å˜é‡
- æ— é‡å¤å¯¼å…¥
- ä½¿ç”¨ const è€Œé let
- æ—  console.log (ç”Ÿäº§ç¯å¢ƒ)
- æ—  debugger è¯­å¥

### æ ·å¼è§„èŒƒ
- 2ç©ºæ ¼ç¼©è¿›
- å•å¼•å·å­—ç¬¦ä¸²
- æ— å°¾éšç©ºæ ¼
- ç»Ÿä¸€çš„åˆ†å·ä½¿ç”¨
- åˆç†çš„ç©ºè¡Œ

## ğŸ”§ CI/CD é›†æˆ

### GitHub Actions é›†æˆ

åœ¨ `.github/workflows/smart-cicd.yml` ä¸­ï¼Œå‰ç«¯è´¨é‡æ£€æŸ¥ä»»åŠ¡ä¼šæ‰§è¡Œï¼š

```yaml
- name: Code quality check
  run: |
    cd frontend-taro
    echo "=== å‰ç«¯ä»£ç è´¨é‡æ£€æŸ¥ ==="
    
    # ESLintæ£€æŸ¥ - ä½¿ç”¨warnæ¨¡å¼ï¼Œé¿å…å› ä»£ç é£æ ¼é—®é¢˜å¯¼è‡´å¤±è´¥
    npm run lint || {
      echo "âš ï¸ ESLintæ£€æŸ¥å‘ç°é—®é¢˜ï¼Œä½†ç»§ç»­æ‰§è¡Œ"
      echo "å»ºè®®ï¼šä¿®å¤ä»£ç é£æ ¼é—®é¢˜ä»¥æé«˜ä»£ç è´¨é‡"
    }
    
    # TypeScriptæ£€æŸ¥
    npm run type-check || {
      echo "âš ï¸ TypeScriptç±»å‹æ£€æŸ¥å‘ç°é—®é¢˜ï¼Œä½†ç»§ç»­æ‰§è¡Œ"
      echo "å»ºè®®ï¼šä¿®å¤ç±»å‹é”™è¯¯ä»¥æé«˜ä»£ç è´¨é‡"
    }
    
    echo "âœ… å‰ç«¯ä»£ç è´¨é‡æ£€æŸ¥å®Œæˆ"
```

### è´¨é‡é—¨ç¦

- **é€šè¿‡æ ‡å‡†**: 80% ä»¥ä¸Šæ£€æŸ¥é€šè¿‡
- **å¤±è´¥å¤„ç†**: æ˜¾ç¤ºè­¦å‘Šä½†ç»§ç»­æ‰§è¡Œ
- **æŠ¥å‘Šç”Ÿæˆ**: è‡ªåŠ¨ç”Ÿæˆè´¨é‡æŠ¥å‘Š

## ğŸ“ å¼€å‘å·¥ä½œæµ

### 1. å¼€å‘å‰
```bash
# å®‰è£…ä¾èµ–
npm install

# è¿è¡Œè´¨é‡æ£€æŸ¥
npm run quality-check
```

### 2. å¼€å‘ä¸­
```bash
# ç›‘å¬æ¨¡å¼è¿è¡Œæµ‹è¯•
npm run test:watch

# ç›‘å¬æ¨¡å¼ç±»å‹æ£€æŸ¥
npm run type-check:watch

# è‡ªåŠ¨æ ¼å¼åŒ–
npm run format
```

### 3. æäº¤å‰
```bash
# è¿è¡Œå®Œæ•´è´¨é‡æ£€æŸ¥
npm run quality-check

# è‡ªåŠ¨ä¿®å¤é—®é¢˜
npm run quality-check:fix
```

### 4. æäº¤æ—¶
- Husky è‡ªåŠ¨è¿è¡Œ `pre-commit` é’©å­
- æ‰§è¡Œ `npm run quality-check:simple`

## ğŸ› å¸¸è§é—®é¢˜

### 1. ESLint é”™è¯¯
```bash
# æŸ¥çœ‹å…·ä½“é”™è¯¯
npm run lint

# è‡ªåŠ¨ä¿®å¤
npm run lint:fix
```

### 2. TypeScript ç±»å‹é”™è¯¯
```bash
# æŸ¥çœ‹ç±»å‹é”™è¯¯
npm run type-check

# ä¿®å¤ç±»å‹å®šä¹‰
# ç¼–è¾‘å¯¹åº”çš„ .ts/.tsx æ–‡ä»¶
```

### 3. æ ·å¼æ£€æŸ¥é”™è¯¯
```bash
# æŸ¥çœ‹æ ·å¼é”™è¯¯
npm run lint:css

# è‡ªåŠ¨ä¿®å¤
npm run lint:css:fix
```

### 4. æµ‹è¯•å¤±è´¥
```bash
# è¿è¡Œæµ‹è¯•æŸ¥çœ‹é”™è¯¯
npm run test

# ä¿®å¤æµ‹è¯•ç”¨ä¾‹
# ç¼–è¾‘å¯¹åº”çš„ .test.ts/.test.tsx æ–‡ä»¶
```

## ğŸ“ˆ è´¨é‡æ”¹è¿›å»ºè®®

### 1. ä»£ç è´¨é‡
- å‡å°‘å‡½æ•°å¤æ‚åº¦
- æå–å…¬å…±é€»è¾‘
- ä½¿ç”¨ TypeScript ä¸¥æ ¼æ¨¡å¼
- å¢åŠ å•å…ƒæµ‹è¯•è¦†ç›–ç‡

### 2. æ€§èƒ½ä¼˜åŒ–
- é¿å…ä¸å¿…è¦çš„é‡æ¸²æŸ“
- ä½¿ç”¨ React.memo å’Œ useMemo
- ä¼˜åŒ–å›¾ç‰‡å’Œèµ„æºåŠ è½½
- å‡å°‘åŒ…ä½“ç§¯

### 3. å¯ç»´æŠ¤æ€§
- ç»Ÿä¸€çš„ä»£ç é£æ ¼
- æ¸…æ™°çš„æ³¨é‡Šå’Œæ–‡æ¡£
- æ¨¡å—åŒ–è®¾è®¡
- é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ”— ç›¸å…³é“¾æ¥

- [ESLint å®˜æ–¹æ–‡æ¡£](https://eslint.org/)
- [Stylelint å®˜æ–¹æ–‡æ¡£](https://stylelint.io/)
- [Prettier å®˜æ–¹æ–‡æ¡£](https://prettier.io/)
- [TypeScript å®˜æ–¹æ–‡æ¡£](https://www.typescriptlang.org/)
- [Jest å®˜æ–¹æ–‡æ¡£](https://jestjs.io/)
- [Taro å®˜æ–¹æ–‡æ¡£](https://taro-docs.jd.com/)

---

**æ³¨æ„**: æœ¬æŒ‡å—ä¼šéšç€é¡¹ç›®å‘å±•æŒç»­æ›´æ–°ï¼Œè¯·å®šæœŸæŸ¥çœ‹æœ€æ–°ç‰ˆæœ¬ã€‚
